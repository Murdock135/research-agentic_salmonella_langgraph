<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333" />
    </marker>
    <style>
      .node { fill: #eef; stroke: #447; stroke-width: 2; }
      .text { font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: #222; }
      .title { font-weight: bold; }
      .edge { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .dashed { stroke-dasharray: 6 6; }
      .cluster { fill: #fafafa; stroke: #bbb; }
    </style>
  </defs>

  <!-- START and END -->
  <circle cx="80" cy="80" r="24" fill="#fff" stroke="#333" stroke-width="2" />
  <text x="80" y="85" text-anchor="middle" class="text">START</text>

  <circle cx="260" cy="600" r="28" fill="#fff" stroke="#333" stroke-width="3" />
  <text x="260" y="605" text-anchor="middle" class="text">END</text>

  <circle cx="1080" cy="600" r="28" fill="#fff" stroke="#333" stroke-width="3" />
  <text x="1080" y="605" text-anchor="middle" class="text">END</text>

  <!-- Router -->
  <rect class="node" x="160" y="50" width="220" height="90" rx="6" ry="6" />
  <text class="text title" x="270" y="75" text-anchor="middle">Router</text>
  <text class="text" x="270" y="95" text-anchor="middle">nodes/router.py</text>
  <text class="text" x="270" y="115" text-anchor="middle">output: route, answer?</text>

  <!-- Answer branch -->
  <rect class="node" x="160" y="520" width="200" height="60" rx="6" ry="6" />
  <text class="text" x="260" y="545" text-anchor="middle">Answer returned</text>
  <text class="text" x="260" y="565" text-anchor="middle">state.answer</text>

  <!-- Planner -->
  <rect class="node" x="440" y="50" width="230" height="100" rx="6" ry="6" />
  <text class="text title" x="555" y="75" text-anchor="middle">Planner</text>
  <text class="text" x="555" y="95" text-anchor="middle">nodes/planner.py</text>
  <text class="text" x="555" y="115" text-anchor="middle">outputs: plan, data_manifest, df_summaries</text>

  <!-- Executor -->
  <rect class="node" x="740" y="50" width="220" height="80" rx="6" ry="6" />
  <text class="text title" x="850" y="75" text-anchor="middle">Executor</text>
  <text class="text" x="850" y="95" text-anchor="middle">nodes/executor.py</text>

  <!-- Aggregator -->
  <rect class="node" x="1020" y="50" width="220" height="80" rx="6" ry="6" />
  <text class="text title" x="1130" y="75" text-anchor="middle">Aggregator</text>
  <text class="text" x="1130" y="95" text-anchor="middle">nodes/aggregator.py</text>

  <!-- Saver -->
  <rect class="node" x="1020" y="180" width="220" height="80" rx="6" ry="6" />
  <text class="text title" x="1130" y="205" text-anchor="middle">Saver</text>
  <text class="text" x="1130" y="225" text-anchor="middle">nodes/saver.py</text>
  <text class="text" x="1130" y="245" text-anchor="middle">writes: trace.json, final_answer.json</text>

  <!-- Edges main path -->
  <path class="edge" d="M104,80 L160,80" />
  <path class="edge" d="M380,95 L440,95" />
  <path class="edge" d="M670,95 L740,95" />
  <path class="edge" d="M960,90 L1020,90" />
  <path class="edge" d="M1130,130 L1130,180" />
  <path class="edge" d="M260,520 L260,628" />
  <path class="edge" d="M1130,260 C1130,440 1080,520 1080,572" />

  <!-- Conditional branch labels -->
  <text class="text" x="300" y="70">route=True</text>
  <path class="edge" d="M270,140 C260,200 240,320 260,520" />
  <text class="text" x="225" y="220" transform="rotate(-75 225 220)">route=False</text>

  <!-- Tools cluster -->
  <rect class="cluster" x="680" y="260" width="520" height="260" rx="8" ry="8" />
  <text class="text title" x="940" y="285" text-anchor="middle">Executor Tools</text>

  <rect class="node" x="700" y="300" width="220" height="60" rx="6" ry="6" />
  <text class="text" x="810" y="325" text-anchor="middle">filesystemtools</text>
  <text class="text" x="810" y="345" text-anchor="middle">write/read/list/search</text>

  <rect class="node" x="940" y="300" width="220" height="40" rx="6" ry="6" />
  <text class="text" x="1050" y="325" text-anchor="middle">python_repl</text>

  <rect class="node" x="700" y="380" width="220" height="40" rx="6" ry="6" />
  <text class="text" x="810" y="405" text-anchor="middle">load_dataset</text>

  <rect class="node" x="940" y="380" width="220" height="40" rx="6" ry="6" />
  <text class="text" x="1050" y="405" text-anchor="middle">get_sheet_names</text>

  <rect class="node" x="700" y="440" width="220" height="40" rx="6" ry="6" />
  <text class="text" x="810" y="465" text-anchor="middle">find_csv_excel_files</text>

  <rect class="node" x="940" y="440" width="220" height="60" rx="6" ry="6" />
  <text class="text" x="1050" y="465" text-anchor="middle">get_cached_dataset_path</text>
  <text class="text" x="1050" y="485" text-anchor="middle">(HF cache)</text>

  <!-- Single dashed link from Executor to Tools cluster (consuming box) -->
  <path class="edge dashed" d="M850,130 C900,180 940,230 940,260" />

</svg>
